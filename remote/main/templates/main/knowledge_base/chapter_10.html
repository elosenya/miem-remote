{% extends "main/base.html" %}
{% load static %}
{%block backbutton%}
<a class="nav-link link-secondary fs-4 p-3" href="{% url 'database'%}">К списку глав</a>
{%endblock backbutton%}
{% block content%}

  <div class="col-lg-8 mx-auto p-4 py-md-5">
    <main>

      <h1 class="text-body-emphasis">Глава 10. Технологии VPN, NAT.</h1>

      <p>Локальные сети обычно реализуются с использованием частных IPv4-адресов в соответствии с RFC1918 они используются в рамках организации с целью обеспечения взаимодействия устройств на локальном уровне. Для того чтобы разрешить устройству с частным IPv4-адресом получать доступ к устройствам и ресурсам вне локальной сети частный адрес сначала необходимо преобразовать в публичный адрес: NAT (Network Address Translation трансляция сетевых адресов) обеспечивает преобразование частных адресов в публичные адреса.</p>

        <table style="border-collapse: collapse; width: 100%;">
  <thead style="background-color: #1b2a5f; color: white;">
    <tr>
      <th style="border: 1px solid black; padding: 8px;">Класс</th>
      <th style="border: 1px solid black; padding: 8px;">Диапазон адресов</th>
      <th style="border: 1px solid black; padding: 8px;">Сеть/Маска</th>
    </tr>
  </thead>
  <tbody>
    <tr style="background-color: #d9e1f2;">
      <td style="border: 1px solid black; padding: 8px;">A</td>
      <td style="border: 1px solid black; padding: 8px;">10.0.0.0 – 10.255.255.255</td>
      <td style="border: 1px solid black; padding: 8px;">10.0.0.0/8</td>
    </tr>
    <tr>
      <td style="border: 1px solid black; padding: 8px;">B</td>
      <td style="border: 1px solid black; padding: 8px;">172.16.0.0 – 172.31.255.255</td>
      <td style="border: 1px solid black; padding: 8px;">172.16.0.0/12</td>
    </tr>
    <tr style="background-color: #d9e1f2;">
      <td style="border: 1px solid black; padding: 8px;">C</td>
      <td style="border: 1px solid black; padding: 8px;">192.168.0.0 – 192.168.255.255</td>
      <td style="border: 1px solid black; padding: 8px;">192.168.0.0/16</td>
    </tr>
  </tbody>
</table>

<img src="{% static 'knowledge_base/nat1.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">

<p>Основной задачей NAT является экономия публичных IPv4-адресов. NAT позволяет сетям использовать частные адреса внутри локальной сети и преобразовывать их в общедоступный адрес при необходимости выхода в интернет или вышестоящие сети. Маршрутизатор NAT обычно работает на границе сети. Когда устройство внутри локальной сети хочет взаимодействовать с устройством вне его сети пакет пересылается на пограничный маршрутизатор который выполняет NAT-ирование преобразуя внутренний частный адрес устройства в общедоступный внешний маршрутизируемый адрес.</p>

        <figure class="text-center">
        <img src="{% static 'knowledge_base/nat2.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">
        <figcaption>Принцип работы NAT</figcaption>
      </figure>


<h3>Принцип работы NAT</h3>

<p>ПК1 хочет установить связь с сервером с открытым адресом 209.165.201.1:</p>
<ol>
    <li>ПК1 отправляет пакет адресованный веб-серверу.</li>
    <li>R2 получает пакет и считывает адрес источника IPv4 чтобы определить нуждается ли он в переводе.</li>
    <li>Маршрутизатор R2 добавляет это сопоставление локального и глобального адресов в таблицу NAT.</li>
    <li>R2 отправляет по назначению пакет с преобразованным адресом источника.</li>
    <li>Веб-сервер отвечает пакетом адресованным внутреннему глобальному адресу ПК1 (209.165.200.226).</li>
    <li>R2 получает пакет с адресом назначения 209.165.200.226. R2 проверяет таблицу NAT и находит запись для этого сопоставления. R2 использует эту информацию и преобразует внутренний глобальный адрес (209.165.200.226) во внутренний локальный адрес (192.168.10.10) после чего пакет пересылается ПК1.</li>
</ol>

<h3>Типы адресов</h3>

<ul>
    <li><b>Внутренний локальный адрес</b> — это адрес источника видимый из внутренней сети. Обычно это частный IPv4-адрес. Внутренним локальным адресом ПК 1 является 192.168.10.10.</li>
    <li><b>Внутренний глобальный адрес</b> — это адрес источника видимый из внешней сети. Внутренний глобальный адрес PC1 209.165.200.226.</li>
    <li><b>Внешний глобальный адрес</b> — это адрес назначения видимый из внешней сети. Внешний глобальный адрес веб-сервера 209.165.201.1.</li>
    <li><b>Внешний локальный адрес</b> — это адрес назначения видимый из внутренней сети. ПК 1 отправляет трафик веб-серверу с IPv4-адресом 209.165.201.1. В редких случаях этот адрес может отличаться от глобально маршрутизируемого адреса назначения.</li>
</ul>

        <img src="{% static 'knowledge_base/nat3.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">

<p>Недостатки NAT:</p>
<ul>
    <li>NAT увеличивает задержки пересылки.</li>
    <li>Конечная адресация теряется.</li>
    <li>Теряется сквозная отслеживаемость IPv4-адресов.</li>
    <li>NAT усложняет использование протоколов туннелирования таких как IPsec.</li>
    <li>Работа служб требующих инициализации подключений TCP из внешней сети или использующих протоколы без учета состояния например на основе UDP может быть нарушена.</li>
</ul>

<p><b>VPN</b> (Virtual Private Network) — виртуальная частная сеть технология организации защищенного канала связи поверх сетей с передачей пакетов (инкапсуляция). VPN необходим для надежной и безопасной передачи данных через открытые сети например через Интернет. Данные хоть и передаются по открытым сетям но достаточно хорошо защищены алгоритмами шифрования аутентификацией средствами защиты от изменения данных. Наиболее частое применение VPN приходится на различные организации.</p>

        <img src="{% static 'knowledge_base/vpn1.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">

<p>VPN типа site-to-site определяется шлюзами VPN. VPN трафик шифруется только между шлюзами. Внутренние узлы не знают о существовании VPN.</p>

        <img src="{% static 'knowledge_base/vpn2.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">

<p>VPN можно управлять и развертывать как:</p>
<ul>
    <li>VPN для крупных компаний — распространенное решение для защиты корпоративного трафика через Интернет. VPN типа site-to-site и удаленный доступ создаются и управляются предприятием с использованием IPsec и SSL VPN.</li>
    <li>VPN операторов связи — создаются и управляются через сеть провайдера. Провайдер использует многопротокольную коммутацию по меткам (MPLS) на уровне 2 или уровне 3 для создания безопасных каналов между сайтами предприятия эффективно отделяя трафик от трафика других клиентов.</li>
</ul>

<h3>VPN с удалённым доступом</h3>

<p>VPN с удалённым доступом позволяют удаленным и мобильным пользователям безопасно подключаться к предприятию. Сети VPN для удаленного доступа обычно включаются пользователем динамически когда это необходимо они могут создаваться с использованием различных протоколов. Бесклиентное соединение — соединение защищено с помощью SSL-соединения через браузер. Клиентское соединение — программное обеспечение VPN-клиента должно быть установлено на конечном устройстве удаленного пользователя или быть встроено в операционную систему.</p>

<h3>Site-to-site VPN</h3>

<p>Site-to-site VPN используются для подключения сетей через другую ненадежную сеть такую как Интернет. Оконечные компьютеры отправляют и получают обычный трафик TCP/IP через шлюз VPN или маршрутизатор. Шлюз VPN или маршрутизатор инкапсулирует и шифрует исходящий трафик и отправляет трафик через VPN-туннель на шлюз VPN на целевом устройстве. Получающий данные шлюз VPN удаляет заголовки расшифровывает содержимое и передает пакет в узел назначения своей сети.</p>

<h3>Использование VPN</h3>

<p>Обычно VPN работает на 2 и/или 3 уровне OSI но есть и другие реализации. Есть множество различных VPN протоколов такие как: OpenVPN PPTP L2TP/IPSec IKEv2 SSTP WireGuard и другие но чаще всего используются перечисленные выше. Также кроме вышеуказанных существуют и специфические реализации VPN (чаще на базе основных протоколов с особыми алгоритмами шифрования) в основном для особо защищенных сетей и критических информационных инфраструктур (например разработки компании InfoTeCS — ViPNet КОД Безопасности — Континент-АП и другие).</p>

        <img src="{% static 'knowledge_base/vpn3.png' %}" class="img-fluid mb-4 mx-auto d-block w-50">
        <div class="container" id="navs_buttons">
        <div class="row justify-content-center">
            <div class="col-auto">
                <a href="?id={{ chapter_id|add:-1 }}" class="btn btn-primary">Предыдущая глава</a>
            </div>
            <div class="col-auto">
                <a href="?id={{ chapter_id|add:1 }}" class="btn btn-primary">Следующая глава</a>
            </div>
        </div>
      </div>
      <img src="{% static 'knowledge_base/Логотип_МИЭМ.svg' %}" class="img-fluid m-5 mx-auto d-block w-25">
    </main>
  </div>

{% endblock content %}